<ion-header>
  <ion-toolbar>
    <ion-title>BattleScribe Tools</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-item-divider>Roster</ion-item-divider>
  <ion-item class="add-roster">
    <ion-label>
      <ion-icon color="primary" slot="start" name="document-outline"></ion-icon>
      Neue Datei (exportierte .rosz Datei)
    </ion-label>
    <ion-button fill="outline" (click)="f.click()">w√§hlen...</ion-button>
    <input
      (change)="saveFile($event); f.value = ''"
      class="ion-hide"
      #f
      type="file"
    />
  </ion-item>
  <ion-item class="add-roster">
    <ion-label>
      <ion-icon color="primary" slot="start" name="document-outline"></ion-icon>
      URL laden
    </ion-label>
    <input #u type="text" />
    <ion-button slot="end" fill="outline" (click)="linkFile(u.value)"
      >laden...</ion-button
    >
  </ion-item>

  <ion-item *ngFor="let roster of rosterList$ | async">
    <ion-label [routerLink]="['roster', roster.id]">
      <ion-icon color="primary" slot="start" name="document-outline"></ion-icon>
      {{ roster.title }}
    </ion-label>
    <ion-buttons slot="end">
      <ion-button
        *ngIf="roster.canUpdate"
        fill="clear"
        (click)="updateFile(roster.id)"
      >
        <ion-icon color="primary" name="reload"></ion-icon>
      </ion-button>
      <ion-button fill="clear" (click)="deleteRoster(roster.id)">
        <ion-icon color="primary" name="trash"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-item>

  <ion-item-divider>
    Flash Card Decks
    <ion-button
      slot="end"
      fill="clear"
      (click)="modal.isOpen = true"
      *ngIf="(rosterList$ | async)?.length"
      ><ion-icon name="add"></ion-icon
    ></ion-button>
  </ion-item-divider>
  <ion-item *ngFor="let deck of deckList$ | async">
    <div slot="start" [routerLink]="['flash-card-lesson', deck.deckId]">
      {{ deck.name }}
    </div>
    <div class="boxes">
      <div
        class="box"
        *ngFor="let cardAmount of deck.boxContent; let i = index"
      >
        <ion-icon
          [name]="
            cardAmount === 0 ? 'file-tray-outline' : 'file-tray-full-outline'
          "
        ></ion-icon>
        <ion-badge
          [color]="deck.boxContent.length - 1 === i ? 'success' : 'medium'"
          >{{ cardAmount }}</ion-badge
        >
      </div>
    </div>
    <ion-button slot="end" fill="clear" (click)="deleteDeck(deck.deckId)">
      <ion-icon color="primary" name="trash"></ion-icon>
    </ion-button>
  </ion-item>
</ion-content>

<bst-translation-settings></bst-translation-settings>

<ion-modal [isOpen]="false" #modal>
  <ng-template>
    <ion-content>
      <ion-header>
        <ion-toolbar>
          <ion-title>
            <h1>Deck erstellen</h1>
          </ion-title>
          <ion-buttons slot="end">
            <ion-button (click)="modal.isOpen = false">
              <ion-icon name="close"></ion-icon>
            </ion-button>
          </ion-buttons>
        </ion-toolbar>
      </ion-header>

      <bst-flash-card-lesson-form
        (lessonCreated)="modal.isOpen = false"
      ></bst-flash-card-lesson-form>
    </ion-content>
  </ng-template>
</ion-modal>
