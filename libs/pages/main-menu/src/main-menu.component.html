<ion-header>
  <ion-toolbar>
    <ion-title>BattleScribe Tools</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-item-divider>Roster</ion-item-divider>
  <ion-item>
    <ion-label>
      <ion-icon color="primary" slot="start" name="document-outline"></ion-icon>
      Neue Datei (exportierte .rosz Datei)
    </ion-label>
    <ion-button fill="outline" (click)="f.click()">wählen...</ion-button>
    <input (change)="saveFile($event)" class="ion-hide" #f type="file" />
  </ion-item>

  <ion-item *ngFor="let roster of rosterTitles$ | async; let i = index">
    <ion-label [routerLink]="['roster', i]">
      <ion-icon color="primary" slot="start" name="document-outline"></ion-icon>
      {{ roster }}
    </ion-label>
    <ion-button slot="end" fill="clear" (click)="deleteRoster(i)">
      <ion-icon color="primary" name="trash"></ion-icon>
    </ion-button>
  </ion-item>

  <ion-item-divider>
    Flash Card Decks
    <ion-button slot="end" fill="clear" (click)="form.isOpen = true"
      ><ion-icon name="add"></ion-icon
    ></ion-button>
  </ion-item-divider>
  <ion-item *ngFor="let lesson of lessons$ | async; let i = index">
    <div [routerLink]="['flash-card-lesson', i]">{{ lesson.name }}</div>
    <div
      slot="end"
      class="boxes"
      *ngFor="let cardAmount of lesson.boxContent; let i = index"
    >
      <ion-icon
        [name]="
          cardAmount === 0 ? 'file-tray-outline' : 'file-tray-full-outline'
        "
      ></ion-icon>
      <ion-badge
        [color]="lesson.boxContent.length - 1 === i ? 'success' : 'medium'"
        >{{ cardAmount }}</ion-badge
      >
    </div>
    <ion-button slot="end" fill="clear" (click)="deleteDeck(i)">
      <ion-icon color="primary" name="trash"></ion-icon>
    </ion-button>
  </ion-item>
</ion-content>

<bst-translation-settings></bst-translation-settings>

<ion-modal [isOpen]="false" #form>
  <ion-content *ngIf="rosterForNewDeck !== null">
    <ion-header>
      <ion-toolbar>
        <ion-title>
          <h1>Deck erstellen</h1>
        </ion-title>
        <ion-buttons slot="end">
          <ion-button (click)="form.isOpen = false">
            <ion-icon name="close"></ion-icon>
          </ion-button>
        </ion-buttons>
      </ion-toolbar>
    </ion-header>
    <ion-list> </ion-list>
    <ion-list [formGroup]="settingsForm">
      <ion-item>
        <ion-label>Roster</ion-label>
        <ion-select formControlName="roster">
          <ion-select-option></ion-select-option>
          <ion-select-option
            *ngFor="let roster of rosterTitles$ | async; let i = index"
            [value]="i"
            (click)="form.isOpen = false"
            >{{ roster }}</ion-select-option
          >
        </ion-select>
      </ion-item>
      <ion-item>
        <h4>Einheiten-Profile</h4>
      </ion-item>
      <ng-container formGroupName="unitProfiles">
        <ion-item>
          <ion-label>Atacken (A)</ion-label>
          <ion-checkbox formControlName="attacks"></ion-checkbox>
        </ion-item>
        <ion-item>
          <ion-label>Ballistische Fähigkeit (BF)</ion-label>
          <ion-checkbox formControlName="ballisticSkill"></ion-checkbox>
        </ion-item>
        <ion-item>
          <ion-label>Moralwert (MW)</ion-label>
          <ion-checkbox formControlName="leadership"></ion-checkbox>
        </ion-item>
        <ion-item>
          <ion-label>Rüstungswert (RW)</ion-label>
          <ion-checkbox formControlName="save"></ion-checkbox>
        </ion-item>
        <ion-item>
          <ion-label>Wiederstand (W)</ion-label>
          <ion-checkbox formControlName="toughness"></ion-checkbox>
        </ion-item>
        <ion-item>
          <ion-label>Kampfgeschick (KG)</ion-label>
          <ion-checkbox formControlName="weaponSkill"></ion-checkbox>
        </ion-item>
        <ion-item>
          <ion-label>Lebenspunkte (LP)</ion-label>
          <ion-checkbox formControlName="wounds"></ion-checkbox>
        </ion-item>
        <ion-item>
          <ion-label>Bewegung (B)</ion-label>
          <ion-checkbox formControlName="movement"></ion-checkbox>
        </ion-item>
        <ion-item>
          <ion-label>Stärke (S)</ion-label>
          <ion-checkbox formControlName="strength"></ion-checkbox>
        </ion-item>
      </ng-container>
      <ng-container formGroupName="weaponProfiles">
        <ion-item>
          <h4>Waffen-Profile</h4>
        </ion-item>
        <ion-item>
          <ion-label>Fähigkeiten</ion-label>
          <ion-checkbox formControlName="abilities"></ion-checkbox>
        </ion-item>
        <ion-item>
          <ion-label>Durchschlag (DS)</ion-label>
          <ion-checkbox formControlName="armourPenetration"></ion-checkbox>
        </ion-item>
        <ion-item>
          <ion-label>Schadenswert (SW)</ion-label>
          <ion-checkbox formControlName="damage"></ion-checkbox>
        </ion-item>
        <ion-item>
          <ion-label>Reichweite</ion-label>
          <ion-checkbox formControlName="range"></ion-checkbox>
        </ion-item>
        <ion-item>
          <ion-label>Stärke (S)</ion-label>
          <ion-checkbox formControlName="strength"></ion-checkbox>
        </ion-item>
        <ion-item>
          <ion-label>Typ</ion-label>
          <ion-checkbox formControlName="type"></ion-checkbox>
        </ion-item>
        <ion-item>
          <h4>Sonstiges</h4>
        </ion-item>
      </ng-container>
      <ion-item>
        <ion-label>Regeln</ion-label>
        <ion-checkbox formControlName="rules"></ion-checkbox>
      </ion-item>
      <ion-item>
        <h4>Einstellungen</h4>
      </ion-item>
      <ion-item>
        <ion-label>Karten-Boxen</ion-label>
        <ion-input
          formControlName="boxes"
          type="number"
          inputmode="numeric"
          value="3"
        ></ion-input>
      </ion-item>
      <ion-button (click)="createDeck(); form.isOpen = false" expand="full"
        >Deck erstellen</ion-button
      >
    </ion-list>
  </ion-content>
</ion-modal>
