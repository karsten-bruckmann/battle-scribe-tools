<ion-header>
  <ion-toolbar>
    <ion-title>BattleScribe Tools</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-item-divider>Roster</ion-item-divider>
  <ion-item class="add-roster">
    <ion-label>
      <ion-icon color="primary" slot="start" name="document-outline"></ion-icon>
      Neue Datei (exportierte .rosz Datei)
    </ion-label>
    <ion-button fill="outline" (click)="f.click()">w√§hlen...</ion-button>
    <input
      (change)="saveFile($event); f.value = ''"
      class="ion-hide"
      #f
      type="file"
    />
  </ion-item>
  <ion-item class="add-roster">
    <ion-label>
      <ion-icon color="primary" slot="start" name="document-outline"></ion-icon>
      URL laden
    </ion-label>
    <input #u type="text" />
    <ion-button slot="end" fill="outline" (click)="linkFile(u.value)"
      >laden...</ion-button
    >
  </ion-item>

  <ion-item *ngFor="let roster of rosterList$ | async; let i = index">
    <ion-label [routerLink]="['roster', i]">
      <ion-icon color="primary" slot="start" name="document-outline"></ion-icon>
      {{ roster.title }}
    </ion-label>
    <ion-buttons slot="end">
      <ion-button *ngIf="roster.canUpdate" fill="clear" (click)="updateFile(i)">
        <ion-icon color="primary" name="reload"></ion-icon>
      </ion-button>
      <ion-button fill="clear" (click)="deleteRoster(i)">
        <ion-icon color="primary" name="trash"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-item>

  <ion-item-divider>
    Flash Card Decks
    <ion-button slot="end" fill="clear" (click)="modal.isOpen = true"
      ><ion-icon name="add"></ion-icon
    ></ion-button>
  </ion-item-divider>
  <ion-item *ngFor="let lesson of lessons$ | async; let i = index">
    <div [routerLink]="['flash-card-lesson', i]">{{ lesson.name }}</div>
    <div
      slot="end"
      class="boxes"
      *ngFor="let cardAmount of lesson.boxContent; let i = index"
    >
      <ion-icon
        [name]="
          cardAmount === 0 ? 'file-tray-outline' : 'file-tray-full-outline'
        "
      ></ion-icon>
      <ion-badge
        [color]="lesson.boxContent.length - 1 === i ? 'success' : 'medium'"
        >{{ cardAmount }}</ion-badge
      >
    </div>
    <ion-button slot="end" fill="clear" (click)="deleteDeck(i)">
      <ion-icon color="primary" name="trash"></ion-icon>
    </ion-button>
  </ion-item>
</ion-content>

<bst-translation-settings></bst-translation-settings>

<ion-modal [isOpen]="false" #modal>
  <ng-template>
    <ion-content>
      <ion-header>
        <ion-toolbar>
          <ion-title>
            <h1>Deck erstellen</h1>
          </ion-title>
          <ion-buttons slot="end">
            <ion-button (click)="modal.isOpen = false">
              <ion-icon name="close"></ion-icon>
            </ion-button>
          </ion-buttons>
        </ion-toolbar>
      </ion-header>

      <bst-flash-card-lesson-form
        (lessonCreated)="modal.isOpen = false"
      ></bst-flash-card-lesson-form>
    </ion-content>
  </ng-template>
</ion-modal>
